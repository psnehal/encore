{% extends "layout.html" %}
{% block header %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/job_list.css') }}">
<script type="text/javascript" src="{{ url_for('static', filename='js/job_list.js') }}"></script>

<link rel="stylesheet"
	  href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css">

<!-- DataTables JS -->
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/dt_api_interface.js') }}"></script>



<!-- Bootstrap 5 CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap 5 JS Bundle (includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Bootstrap Dialog (newest maintained version compatible with Bootstrap 5) -->
<link rel="stylesheet"
	  href="https://cdn.jsdelivr.net/npm/bootstrap5-dialog/dist/css/bootstrap-dialog.min.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap5-dialog/dist/js/bootstrap-dialog.min.js"></script>

<!-- Angular (if you still need it) -->
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.3/angular.min.js"></script>

<!-- Font Awesome (latest) -->
<link rel="stylesheet"
	  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">


<style>
	.home-nav-list li {padding: 10px 0}
	#carousel h3 {
		color: rgb(1, 45, 107);
		font-weight: bold;
		font-size: .75em;
		margin: 5px 10px;
	}

	.modal-dialog {
		position: absolute;
		top: 200px;
		right: 100px;
		bottom: 0;
		left: 0;
		z-index: 10040;
		overflow: auto;
		overflow-y: auto;
	}
</style>
<script type="text/javascript">
	function init_job_table(url) {
		$("#jobs-table").DataTable({
			serverSide: true,
			ajax: encoreApi( url ),
			order: [[1, "desc"]],
			columns: [
				{data: "name", title: "Job Name", render: $.fn.dataTable.render.text()},
				{data: "creation_date", title: "Date Created"},
				{data: "status", title: "Status"},
				{title: "Job", data: "id", render: function(data) {
						return "<a href='/jobs/" + data + "'>View</a>"
					}, orderable: false, className: "dt-body-center"}
			]
		})
	};
	$(document).ready(function() {
		init_job_table("{{ url_for("api.get_jobs") }}");
		init_vcf_stats("{{ url_for("api.get_genotypes") }}");

		console.log( {{usigncon}} );

		var usigncon =  {{usigncon}};






		$('#exampleModal').on('click','#paramsOkay', function (e) {
			console.log($('#recipient-name').text());
			console.log(e);
		});


	});
</script>

{% endblock %}
{% block content %}
<div class="container-fluid">
<div class="section row">
	<div class="col-sm-6">
		<h2>Welcome</h2>
		{% if current_user.can_analyze %}

		<ul class="home-nav-list">
			<li><a href="{{ url_for("user.get_pheno_upload") }}">Upload New Phenotype File</a></li>
			{% if phenos %}
			<li><a href="{{ url_for("user.get_model_build") }}">Create New Job from Existing Phenotypes</a>
				</li>
			{% endif %}
		</ul>
		{% else %}
		<p>Browse available jobs below</p>
		{% endif %}
	</div>
	{% if notices %}
	<div id="carousel" class="col-sm-6" style="text-align: center">
		{{ notices[0].message}}
	</div>
	{% else %}
	<div id="carousel" class="col-sm-6 vcf-stats" style="text-align: center">

		<b style="color: rgb(1, 45, 107);">Ready For Analysis!</b>
	</div>
	{% endif %}
</div>
</div>

<div class="section">
	<div class="section-title">
		<h2>Jobs</h2>

	</div>




	<div class="container-fluid mt-3">
		<div class="dt-wrap table-responsive">
			<table id="jobs-table" class="table table-sm table-striped table-bordered align-middle w-100"></table>
		</div>
	</div>




</div>
{% endblock %}
